     1                                 %line 1+1 minibash.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 [section .data]
     8 00000000 4D696E692D42617368-    title db "Mini-Bash",0
     9 00000000 00                 
    10 0000000A 2F7573722F73686172-    pathToFont db "/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf",0
    11 0000000A 652F666F6E74732F74-
    12 0000000A 727565747970652F64-
    13 0000000A 656A6176752F44656A-
    14 0000000A 61567553616E732E74-
    15 0000000A 746600             
    16                                 
    17                                 
    18                                 
    19                                 [section .bss]
    20 00000000 <gap>                  windows resq 1
    21 00000008 <gap>                  render resq 1
    22 00000010 <gap>                  font resq 1
    23 00000018 <gap>                  keyStore resb 1
    24                                 
    25                                 
    26                                 
    27                                 
    28                                 
    29                                 
    30                                 [section .text]
    31                                 [extern printf]
    32                                 [extern SDL_InitSubSystem]
    33                                 [extern SDL_Quit]
    34                                 [extern SDL_CreateWindow]
    35                                 [extern SDL_DestroyWindow]
    36                                 [extern SDL_Delay]
    37                                 [extern SDL_Event]
    38                                 [extern SDL_PollEvent]
    39                                 [extern eventLoop]
    40                                 [extern SDL_CreateRenderer]
    41                                 [extern TTF_Init]
    42                                 [extern SDL_DestroyRenderer]
    43                                 [extern TTF_OpenFont]
    44                                 [extern TTF_CloseFont]
    45                                 [global main]
    46                                 %line 38+0 minibash.asm
    47                                 [global render]
    48                                 [global font]
    49                                 [global windows]
    50                                 %line 39+1 minibash.asm
    51                                 
    52                                 
    53                                 
    54                                 
    55                                 
    56                                 main:
    57 00000000 55                     push rbp
    58 00000001 4889E5                 mov rbp,rsp
    59                                 
    60                                 
    61 00000004 48C7C720000000         mov rdi,0x20
    62 0000000B E8(F6FFFFFF)           call SDL_InitSubSystem
    63 00000010 4883F800               cmp rax,0
    64 00000014 0F85D2000000           jnz end
    65                                 
    66                                 
    67 0000001A E8(F6FFFFFF)           call TTF_Init
    68 0000001F 4883F8FF               cmp rax ,-1
    69 00000023 0F84C3000000           jz end
    70                                 
    71                                 
    72                                 windowCreation:
    73 00000029 488D3C25[00000000]     lea rdi,[title]
    74 00000031 48C7C664000000         mov rsi,100
    75 00000038 48C7C264000000         mov rdx,100
    76 0000003F 48C7C1F4010000         mov rcx,500
    77 00000046 49C7C0F4010000         mov r8,500
    78 0000004D 49C7C120000000         mov r9,0x20
    79 00000054 4981C900200000         or r9,0x2000
    80 0000005B E8(F6FFFFFF)           call SDL_CreateWindow
    81 00000060 4883F800               cmp rax,0
    82 00000064 0F8482000000           jz end
    83                                 
    84 0000006A 48890425[00000000]     mov qword[windows],rax
    85                                 
    86                                 renderCreation:
    87 00000072 488B3C25[00000000]     mov rdi,qword[windows]
    88 0000007A 48C7C6FFFFFFFF         mov rsi,-1
    89 00000081 48C7C202000000         mov rdx,0x2
    90 00000088 4883CA04               or rdx,0x4
    91 0000008C E8(F6FFFFFF)           call SDL_CreateRenderer
    92 00000091 4883F800               cmp rax,0
    93 00000095 742D                   jz releaseResources
    94 00000097 48890425[00000000]     mov qword[render],rax
    95                                 
    96                                 fontOpening:
    97 0000009F 488D3C25[00000000]     lea rdi,[pathToFont]
    98 000000A7 48C7C612000000         mov rsi,18
    99 000000AE E8(F6FFFFFF)           call TTF_OpenFont
   100 000000B3 4883F800               cmp rax,0
   101 000000B7 740B                   jz releaseResources
   102 000000B9 48890425[00000000]     mov qword[font],rax
   103                                 
   104                                 
   105 000000C1 E8(F6FFFFFF)           call eventLoop
   106                                 
   107                                 releaseResources:
   108 000000C6 488B3C25[00000000]     mov rdi,qword[font]
   109 000000CE E8(F6FFFFFF)           call TTF_CloseFont
   110 000000D3 488B3C25[00000000]     mov rdi,qword[render]
   111 000000DB E8(F6FFFFFF)           call SDL_DestroyRenderer
   112 000000E0 488B3C25[00000000]     mov rdi,qword[windows]
   113 000000E8 E8(F6FFFFFF)           call SDL_DestroyWindow
   114 000000ED E8(F6FFFFFF)           call SDL_Quit
   115                                 
   116                                 end:
   117 000000F2 5D                     pop rbp
   118 000000F3 4831C0                 xor rax,rax
   119 000000F6 C3                     ret
